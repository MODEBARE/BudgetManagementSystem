@model BudgetSystem.ViewModels.AccountDetailsViewModel

@{
    ViewData["Title"] = "Account Details";
    var currencySymbol = Model.GetCurrencySymbol();
}

<div class="container-fluid">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="fw-bold mb-1">Account Details</h2>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb mb-0">
                            <li class="breadcrumb-item"><a asp-controller="Dashboard" asp-action="Index">Dashboard</a></li>
                            <li class="breadcrumb-item"><a asp-controller="MyAccounts" asp-action="Index">My Accounts</a></li>
                            <li class="breadcrumb-item active" aria-current="page">@Model.Account.Name</li>
                        </ol>
                    </nav>
                </div>
                <div>
                    <a asp-controller="MyAccounts" asp-action="Index" class="btn btn-outline-secondary me-2">
                        <i class="fas fa-arrow-left"></i> Back to Accounts
                    </a>
                    <a asp-controller="MyAccounts" asp-action="Edit" asp-route-id="@Model.Account.Id" class="btn btn-primary">
                        <i class="fas fa-edit"></i> Edit Account
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Overview -->
    <div class="row mb-4">
        <div class="col-md-8">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-bottom">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-info-circle me-2"></i>Account Information
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="text-muted small fw-bold">ACCOUNT NAME</label>
                                <p class="mb-0 fs-5 fw-bold">@Model.Account.Name</p>
                            </div>
                            <div class="mb-3">
                                <label class="text-muted small fw-bold">ACCOUNT TYPE</label>
                                <p class="mb-0">
                                    @{
                                        var accountTypeClass = Model.Account.AccountType switch
                                        {
                                            AccountType.Checking => "text-primary",
                                            AccountType.Savings => "text-success",
                                            AccountType.CreditCard => "text-warning",
                                            AccountType.Investment => "text-info",
                                            AccountType.Cash => "text-secondary",
                                            _ => "text-dark"
                                        };
                                        var accountTypeIcon = Model.Account.AccountType switch
                                        {
                                            AccountType.Checking => "fas fa-university",
                                            AccountType.Savings => "fas fa-piggy-bank",
                                            AccountType.CreditCard => "fas fa-credit-card",
                                            AccountType.Investment => "fas fa-chart-line",
                                            AccountType.Cash => "fas fa-money-bill-wave",
                                            _ => "fas fa-wallet"
                                        };
                                    }
                                    <span class="@accountTypeClass">
                                        <i class="@accountTypeIcon me-2"></i>@Model.Account.AccountType
                                    </span>
                                </p>
                            </div>
                            <div class="mb-3">
                                <label class="text-muted small fw-bold">STATUS</label>
                                <p class="mb-0">
                                    @if (Model.Account.IsActive)
                                    {
                                        <span class="badge bg-success fs-6">
                                            <i class="fas fa-check-circle me-1"></i>Active
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-secondary fs-6">
                                            <i class="fas fa-pause-circle me-1"></i>Inactive
                                        </span>
                                    }
                                </p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="text-muted small fw-bold">CURRENT BALANCE</label>
                                <p class="mb-0 fs-3 fw-bold text-primary">
                                    @currencySymbol@Model.Account.CurrentBalance.ToString("N2")
                                </p>
                            </div>
                            <div class="mb-3">
                                <label class="text-muted small fw-bold">INITIAL BALANCE</label>
                                <p class="mb-0 fs-5">
                                    @currencySymbol@Model.Account.InitialBalance.ToString("N2")
                                </p>
                            </div>
                            <div class="mb-3">
                                <label class="text-muted small fw-bold">CREATED DATE</label>
                                <p class="mb-0">
                                    @Model.Account.CreatedAt.ToString("MMMM d, yyyy")
                                </p>
                            </div>
                        </div>
                    </div>
                    @if (!string.IsNullOrEmpty(Model.Account.Description))
                    {
                        <hr>
                        <div>
                            <label class="text-muted small fw-bold">DESCRIPTION</label>
                            <p class="mb-0">@Model.Account.Description</p>
                        </div>
                    }
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card border-0 shadow-sm h-100">
                <div class="card-header bg-white border-bottom">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-chart-bar me-2"></i>Quick Stats
                    </h5>
                </div>
                <div class="card-body">
                    <div class="text-center mb-3">
                        <div class="fw-bold text-muted">Balance Change</div>
                        @{
                            var balanceChange = Model.Account.CurrentBalance - Model.Account.InitialBalance;
                            var changeClass = balanceChange >= 0 ? "text-success" : "text-danger";
                            var changeIcon = balanceChange >= 0 ? "fas fa-arrow-up" : "fas fa-arrow-down";
                        }
                        <div class="fs-4 fw-bold @changeClass">
                            <i class="@changeIcon me-1"></i>@currencySymbol@Math.Abs(balanceChange).ToString("N2")
                        </div>
                    </div>
                    <hr>
                    <div class="row text-center">
                        <div class="col-6">
                            <div class="fw-bold text-muted small">Total Transactions</div>
                            <div class="fs-5 fw-bold">@Model.TransactionStats.TotalTransactions</div>
                        </div>
                        <div class="col-6">
                            <div class="fw-bold text-muted small">Net Income</div>
                            <div class="fs-5 fw-bold text-success">
                                @currencySymbol@Model.TransactionStats.NetIncome.ToString("N2")
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Transaction Statistics -->
    <div class="row mb-4">
        <div class="col">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-analytics me-2"></i>Transaction Statistics
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <div class="text-center p-3 bg-light rounded">
                                <i class="fas fa-plus-circle fs-4 text-success mb-2"></i>
                                <div class="fw-bold text-muted small">TOTAL INCOME</div>
                                <div class="fs-5 fw-bold text-success">
                                    @currencySymbol@Model.TransactionStats.TotalIncome.ToString("N2")
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 bg-light rounded">
                                <i class="fas fa-minus-circle fs-4 text-danger mb-2"></i>
                                <div class="fw-bold text-muted small">TOTAL EXPENSES</div>
                                <div class="fs-5 fw-bold text-danger">
                                    @currencySymbol@Model.TransactionStats.TotalExpenses.ToString("N2")
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 bg-light rounded">
                                <i class="fas fa-arrow-right fs-4 text-info mb-2"></i>
                                <div class="fw-bold text-muted small">TRANSFERS IN</div>
                                <div class="fs-5 fw-bold text-info">
                                    @currencySymbol@Model.TransactionStats.TotalTransfersIn.ToString("N2")
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="text-center p-3 bg-light rounded">
                                <i class="fas fa-arrow-left fs-4 text-warning mb-2"></i>
                                <div class="fw-bold text-muted small">TRANSFERS OUT</div>
                                <div class="fs-5 fw-bold text-warning">
                                    @currencySymbol@Model.TransactionStats.TotalTransfersOut.ToString("N2")
                                </div>
                            </div>
                        </div>
                    </div>
                    @if (Model.TransactionStats.FirstTransactionDate.HasValue && Model.TransactionStats.LastTransactionDate.HasValue)
                    {
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="fw-bold text-muted small">FIRST TRANSACTION</div>
                                <div>@Model.TransactionStats.FirstTransactionDate.Value.ToString("MMMM d, yyyy")</div>
                            </div>
                            <div class="col-md-6">
                                <div class="fw-bold text-muted small">LAST TRANSACTION</div>
                                <div>@Model.TransactionStats.LastTransactionDate.Value.ToString("MMMM d, yyyy")</div>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Transactions -->
    <div class="row">
        <div class="col">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5 class="fw-bold mb-0">
                            <i class="fas fa-history me-2"></i>Recent Transactions
                        </h5>
                        <a asp-controller="Transactions" asp-action="Index" asp-route-accountId="@Model.Account.Id" 
                           class="btn btn-sm btn-outline-primary">
                            <i class="fas fa-list me-1"></i>View All
                        </a>
                    </div>
                </div>
                <div class="card-body p-0">
                    @if (Model.RecentTransactions.Any())
                    {
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>Date</th>
                                        <th>Type</th>
                                        <th>Category</th>
                                        <th>Description</th>
                                        <th class="text-end">Amount</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var transaction in Model.RecentTransactions.Take(10))
                                    {
                                        <tr>
                                            <td>
                                                <div class="fw-bold">@transaction.TransactionDate.ToString("MMM dd")</div>
                                                <small class="text-muted">@transaction.TransactionDate.ToString("yyyy")</small>
                                            </td>
                                            <td>
                                                @{
                                                    var typeClass = transaction.Type switch
                                                    {
                                                        TransactionType.Credit => "text-success",
                                                        TransactionType.Debit => "text-danger",
                                                        TransactionType.Transfer => "text-info",
                                                        _ => "text-secondary"
                                                    };
                                                    var typeIcon = transaction.Type switch
                                                    {
                                                        TransactionType.Credit => "fas fa-plus-circle",
                                                        TransactionType.Debit => "fas fa-minus-circle",
                                                        TransactionType.Transfer => "fas fa-exchange-alt",
                                                        _ => "fas fa-circle"
                                                    };
                                                }
                                                <span class="@typeClass">
                                                    <i class="@typeIcon me-1"></i>@transaction.Type
                                                </span>
                                            </td>
                                            <td>
                                                <span class="badge bg-light text-dark">@transaction.Category</span>
                                            </td>
                                            <td>
                                                <div class="fw-bold">@transaction.Description</div>
                                                @if (transaction.Type == TransactionType.Transfer)
                                                {
                                                    @if (transaction.DestinationAccountId.HasValue)
                                                    {
                                                        <small class="text-muted">Transfer to another account</small>
                                                    }
                                                    else
                                                    {
                                                        <small class="text-muted">Transfer from another account</small>
                                                    }
                                                }
                                            </td>
                                            <td class="text-end">
                                                @{
                                                    var amountClass = transaction.Type == TransactionType.Credit ? "text-success" : 
                                                                     transaction.Type == TransactionType.Debit ? "text-danger" : "text-info";
                                                    var sign = transaction.Type == TransactionType.Credit ? "+" : 
                                                              transaction.Type == TransactionType.Debit ? "-" : "";
                                                }
                                                <span class="@amountClass fw-bold">
                                                    @sign@currencySymbol@transaction.Amount.ToString("N2")
                                                </span>
                                            </td>
                                        </tr>
                                    }
                                </tbody>
                            </table>
                        </div>
                    }
                    else
                    {
                        <div class="text-center py-5 text-muted">
                            <i class="fas fa-receipt fs-1 mb-3"></i>
                            <h5>No Transactions Yet</h5>
                            <p>This account doesn't have any transactions yet.</p>
                            <a asp-controller="Transactions" asp-action="Create" asp-route-accountId="@Model.Account.Id" 
                               class="btn btn-primary">
                                <i class="fas fa-plus me-1"></i>Add First Transaction
                            </a>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-white border-bottom">
                    <h5 class="fw-bold mb-0">
                        <i class="fas fa-bolt me-2"></i>Quick Actions
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-3">
                            <a asp-controller="Transactions" asp-action="Create" 
                               asp-route-accountId="@Model.Account.Id" 
                               asp-route-type="Income"
                               class="btn btn-success w-100 mb-2">
                                <i class="fas fa-plus-circle me-2"></i>Add Income
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a asp-controller="Transactions" asp-action="Create" 
                               asp-route-accountId="@Model.Account.Id" 
                               asp-route-type="Expense"
                               class="btn btn-danger w-100 mb-2">
                                <i class="fas fa-minus-circle me-2"></i>Add Expense
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a asp-controller="Transactions" asp-action="Transfer" 
                               asp-route-sourceAccountId="@Model.Account.Id"
                               class="btn btn-info w-100 mb-2">
                                <i class="fas fa-exchange-alt me-2"></i>Transfer Money
                            </a>
                        </div>
                        <div class="col-md-3">
                            <a asp-controller="Transactions" asp-action="Index" 
                               asp-route-accountId="@Model.Account.Id"
                               class="btn btn-outline-primary w-100 mb-2">
                                <i class="fas fa-list me-2"></i>View All Transactions
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div> 